# Archived Sessions — February 2026 (Sessions 1-5)

## 2026-02-15 — Session 1: WhatsApp Bot Sync & Project Polish

### What was worked on

- **Fixed WhatsApp bot not using live data** — Root cause: `BOOTSTRAP.md` in the OpenClaw workspace was overriding the quiet-riots skill. Every new per-peer session ran the onboarding flow instead of calling the API. Deleted BOOTSTRAP.md, rewrote SOUL.md/IDENTITY.md/USER.md with Quiet Riots identity, added strong skill instruction to AGENTS.md, cleared stale sessions, restarted gateway.
- **Verified end-to-end sync** — Bot API `identify`, `join_issue`, `post_feed` all working.
- **Disabled ackReaction on WhatsApp DMs** — Set `ackReaction.direct: false` in openclaw.json.
- **Renamed "Southern Rail Cancellations" to "Rail Cancellations"** — Updated seed.ts, re-seeded database.
- **Updated founder identity** — Changed from "Skye" to "Simon Darling" across all CLAUDE.md files.
- **Committed and pushed** — 64 files, 4,299 insertions (commit `122ea91`).

### Key decisions

- Single bot API endpoint multiplexing all operations via `{ action, params }`
- Phone-based identity for WhatsApp users (E.164 format, auto-generated email)
- BOOTSTRAP.md must never exist in OpenClaw workspace

### Discoveries

- OpenClaw skills need YAML frontmatter to be loaded
- `BOOTSTRAP.md` takes priority over skills in AGENTS.md
- Session `skillsSnapshot` is captured at session creation time — must clear sessions after changes

---

## 2026-02-15 — Session 2: Production Deployment & WhatsApp Bot UX

### What was worked on

1. Database migration: better-sqlite3 to Turso (@libsql/client) — commit `4dd32bb`
2. Vercel deployment & custom domain (`quietriots.com` via GoDaddy DNS)
3. WhatsApp bot production URL fix (localhost to `www.quietriots.com`)
4. Bot model change: Opus to Sonnet (~67s to ~10s response time)
5. WhatsApp bot UX overhaul — numbered text choices (polls don't work on Baileys)
6. API performance: `Promise.all` for independent queries (get_issue: 665ms to 342ms)
7. Claude Code permissions — `Bash(*)` to allow all commands

### Key decisions

- Use `www.` for API URLs (bare domain 307 redirect breaks POST)
- Numbered choices over polls/buttons (Baileys compatibility)
- Sonnet over Opus for bot (7x faster, sufficient quality)
- London region for Vercel functions (closest to Turso in Ireland)

### Discoveries

- Vercel `regions` controls function placement, not static content
- OpenClaw model config must be object path format
- WhatsApp gateway restart kills in-flight message processing (~2s window)

---

## 2026-02-15 — Session 3: Tests, Branding, DevOps & Sleep Prevention

### What was worked on

1. Comprehensive test suite — 126 tests across 12 files (~550ms), Vitest 4
2. Branding overhaul — favicon, OG image (3 iterations), Twitter cards
3. Sleep prevention — LaunchAgent with `caffeinate -s`
4. Vercel GitHub integration — auto-deploy on push to main
5. Developer experience fixes — Claude Code permissions cleanup

### Key decisions

- In-memory libSQL for test isolation (real SQL, not mocks)
- `_setTestDb()` injection pattern over `vi.mock` or env vars
- `caffeinate -s` over `pmset` (simpler, no sudo)

### Discoveries

- WhatsApp uses OG tags for previews, aggressively caches them
- Vercel GitHub App must be installed on the account (not just repo connected)
- Vercel CDN caches static pages — check `x-vercel-cache` header
- Next.js 16 `RequestInit` incompatibility with standard lib

---

## 2026-02-17 — Session 4: WhatsApp Bot Reliability & Watchdog

### What was worked on

1. Diagnosed WhatsApp bot not responding — WiFi drop caused fatal channel exit
2. Built watchdog script (`~/.openclaw/scripts/watchdog.sh`) running every 2 minutes
3. Verified production health — 126/126 tests, bot responding, two real users chatting

### Key decisions

- Watchdog over OpenClaw code fix (can't modify OpenClaw source)
- 2-minute interval with DNS check (skip restart if no network)
- Timestamp comparison over PID monitoring (process survives channel death)

### Discoveries

- OpenClaw doesn't auto-reconnect on DNS failure (ENOTFOUND is fatal)
- Gateway process stays running when WhatsApp channel dies
- Network interface changes cause mDNS crashes (unhandled but non-fatal)

---

## 2026-02-17 (Session 5) — Claude Code Permissions Fix

### What was worked on

1. **Fixed Claude Code permission prompts**
   - Updated `~/.claude/settings.json`: changed `defaultMode` from `"acceptEdits"` to `"bypassPermissions"`
   - Added missing tool permissions: `Read(*)`, `Write(*)`, `WebFetch(*)` to the allow list
   - Kept deny rules for sensitive files (`.env`, secrets, `.ssh`)
   - Takes effect in the next Claude Code session

2. **Verified production health**
   - Tests: 126/126 passing (~666ms)
   - WhatsApp watchdog: still running, has auto-recovered 3 times today
   - No code changes to commit — only local config update

### Key decisions

- **bypassPermissions over acceptEdits** — `acceptEdits` still prompts for Read/Write/WebFetch. `bypassPermissions` skips all prompts (with deny rules still enforced for sensitive files)

### Next steps

- Flesh out profile page
- Add rate limiting to bot API
- Consider `create_issue` bot action
- Set up GitHub Actions CI
- Add `.env.example`
- Consider upgrading OpenClaw (`v2026.2.15` available) — may fix the reconnection bug
- Monitor watchdog log to confirm it catches future WiFi drops automatically
